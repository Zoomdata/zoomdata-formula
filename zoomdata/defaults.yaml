# -*- coding: utf-8 -*-

# Default variables for the Zoomdata LTS 2.6 release deployment

zoomdata:
  # Constants
  prefix: '/opt/zoomdata'
  config_dir: '/etc/zoomdata'
  user: zoomdata
  group: zoomdata

  # Defaults which could be overridden in Pillar
  base_url: 'http://repo.zoomdata.com'
  gpgkey: 'https://repo.zoomdata.com/ZOOMDATA-GPG-KEY.pub'
  release: '2.6'
  repositories:
    - tools
  components:
    - stable
    #- unstable

  bootstrap: False
  enforce: True
  erase: False

  #version: 'latest'
  packages:
    - zoomdata
    - zoomdata-consul
    - zoomdata-query-engine
    - zoomdata-scheduler
    - zoomdata-xvfb

  edc:
    #version: 'latest'
    packages:
      - zoomdata-edc-apache-solr
      - zoomdata-edc-cloudera-search
      - zoomdata-edc-elasticsearch-5.0
      - zoomdata-edc-elasticsearch-6.0
      - zoomdata-edc-impala
      - zoomdata-edc-memsql
      - zoomdata-edc-mongo
      - zoomdata-edc-mssql
      - zoomdata-edc-mysql
      - zoomdata-edc-oracle
      - zoomdata-edc-phoenix-4.7-queryserver
      - zoomdata-edc-postgresql
      - zoomdata-edc-redshift
      - zoomdata-edc-rts
      - zoomdata-edc-sparksql
      - zoomdata-edc-tez

    jdbc:
      drivers: {}
      install: False

  microservices:
    #version: 'latest'
    packages:
      - zoomdata-stream-writer
      - zoomdata-upload-service

  tools:
    packages:
      - zoomdata-zdmanage

  # Comment added to each file modified by the formula
  header: |
    ################################################################################
    ### ATTENTION! WARNING! Managed by Salt (infrastructure automation software) ###
    ### PLEASE DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES MAY BE OVERWRITTEN! ###
    ################################################################################

  limits: {}

  environment: {}

  config:
    zoomdata:
      path: /etc/zoomdata/zoomdata.properties
      properties:
        spring.datasource.url: 'jdbc:postgresql://localhost:5432/zoomdata'
        spring.datasource.username: zoomdata
        spring.datasource.password: 'PleaseChangeMe'
        keyset.destination.params.jdbc_url: 'jdbc:postgresql://localhost:5432/zoomdata-keyset'
        keyset.destination.params.user_name: 'zoomdata'
        keyset.destination.params.password: 'PleaseChangeMe'
        keyset.destination.schema: 'public'
        upload.destination.params.jdbc_url: 'jdbc:postgresql://localhost:5432/zoomdata-upload'
        upload.destination.params.user_name: 'zoomdata'
        upload.destination.params.password: 'PleaseChangeMe'
        upload.destination.schema: 'public'
        upload.batch-size: 1000
        screenshot.daemon.enabled: False
        screenshot.daemon.schedule.rate: '168h'
        screenshots.dashboards.enabled: False
        screenshots.datasource-charts.enabled: False
      merge: True
      update: False
      discard: True
    zoomdata-scheduler:
      path: /etc/zoomdata/scheduler.properties
      properties:
        spring.datasource.url: 'jdbc:postgresql://localhost:5432/zoomdata-scheduler'
        spring.datasource.username: zoomdata
        spring.datasource.password: 'PleaseChangeMe'
      merge: True
      update: False
      discard: True
    zoomdata-spark-proxy:
      path: '/etc/zoomdata/spark-proxy.properties'
      properties: {}
      merge: True
      update: False
      discard: True

  tls:
    name: zoomdata

  services:
    - zoomdata-consul
    - zoomdata-edc-apache-solr
    - zoomdata-edc-cloudera-search
    - zoomdata-edc-elasticsearch-5.0
    - zoomdata-edc-elasticsearch-6.0
    - zoomdata-edc-impala
    #- zoomdata-edc-memsql
    - zoomdata-edc-mongo
    #- zoomdata-edc-mssql
    #- zoomdata-edc-mysql
    #- zoomdata-edc-oracle
    - zoomdata-edc-phoenix-4.7-queryserver
    - zoomdata-edc-postgresql
    #- zoomdata-edc-redshift
    - zoomdata-edc-rts
    - zoomdata-edc-sparksql
    - zoomdata-edc-tez
    - zoomdata-query-engine
    - zoomdata-scheduler
    - zoomdata-stream-writer
    - zoomdata-upload-service
    - zoomdata
    #- zoomdata-xvfb

  setup:
    timeout: 900
    passwords: {}
    branding: {}
    connectors: {}
    license:
      URL: Null
      expirationDate: Null
      licenseType: 'TRIAL'
      userCount: '1'
      concurrentUserCount: '1'
      enforcementLevel: 'PS'
      force: False
    toggles: {}

  backup:
    services: []
    databases: []
    state: Null
    destination: /opt/zoomdata/data/backups
    strptime: '%y-%m-%d_%H:%M:%S'
    retention: Null
    bin: pg_dump --no-password --clean --if-exists --create
    compressor: gzip
    comp_opts: ''
    comp_ext: '_postgre.sql.gz'

  restore:
    bin: psql
    user: postgres
    dir: Null
