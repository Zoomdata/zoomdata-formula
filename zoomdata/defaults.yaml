# -*- coding: utf-8 -*-

zoomdata:
  base_url: 'http://repo.zoomdata.com'
  gpgkey: 'https://repo.zoomdata.com/ZOOMDATA-GPG-KEY.pub'
  release: '2.5'
  components:
    - stable
    #- licensed
    #- unstable

  version: 'latest'
  packages:
    - zoomdata
    - zoomdata-consul
    - zoomdata-scheduler
    - zoomdata-spark-proxy
    - zoomdata-xvfb
    - zoomdata-zdmanage

  edc:
    version: 'latest'
    packages:
      - zoomdata-edc-apache-solr
      - zoomdata-edc-aurora
      - zoomdata-edc-cloudera-search
      - zoomdata-edc-elasticsearch-1.7
      - zoomdata-edc-elasticsearch-2.0
      - zoomdata-edc-impala
      - zoomdata-edc-memsql
      - zoomdata-edc-mssql
      - zoomdata-edc-mysql
      - zoomdata-edc-oracle
      - zoomdata-edc-phoenix-4.5
      - zoomdata-edc-postgresql
      - zoomdata-edc-redshift
      - zoomdata-edc-rts
      - zoomdata-edc-sparksql
      - zoomdata-edc-tez

    jdbc:
      drivers: {}
      install: False

  user: zoomdata
  group: zoomdata

  # Comment added to each file modified by the formula
  header: |
    ################################################################################
    ### ATTENTION! WARNING! Managed by Salt (infrastructure automation software) ###
    ### PLEASE DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES MAY BE OVERWRITTEN! ###
    ################################################################################

  limits:
    nproc:
      soft: 4096
      hard: 4096
    nofile:
      soft: 1048576
      hard: 1048576

  environment:
    zoomdata:
      path: /etc/zoomdata/zoomdata.env
      variables:
        JAVA_OPTS: '-Xss256k -Xms2048m -Xmx8192m'
    zoomdata-scheduler:
      path: /etc/zoomdata/scheduler.env
      variables:
        SCHEDULER_JAVA_OPTS: '-Xms512m -Xmx1024m'
    zoomdata-spark-proxy:
      path: /etc/zoomdata/spark-proxy.env
      variables:
        SPARK_PROXY_JAVA_OPTS: '-Xss256k -Xms512m -Xmx2048m'

  config:
    zoomdata:
      merge: True
      path: /etc/zoomdata/zoomdata.properties
      properties:
        spring.datasource.url: 'jdbc:postgresql://localhost:5432/zoomdata'
        spring.datasource.username: zoomdata
        spring.datasource.password: 'PleaseChangeMe'
        screenshot.daemon.enabled: False
        screenshot.daemon.schedule.rate: '168h'
        screenshots.dashboards.enabled: False
        screenshots.datasource-charts.enabled: False
      update: False
    zoomdata-scheduler:
      merge: True
      path: /etc/zoomdata/scheduler.properties
      properties:
        spring.datasource.url: 'jdbc:postgresql://localhost:5432/zoomdata-scheduler'
        spring.datasource.username: zoomdata
        spring.datasource.password: 'PleaseChangeMe'
      update: False
    zoomdata-spark-proxy:
      merge: True
      path: '/etc/zoomdata/spark-proxy.properties'
      properties: {}
      update: False

  tls:
    name: zoomdata

  prefix: '/opt/zoomdata'

  services:
    - zoomdata-consul
    - zoomdata-edc-apache-solr
    - zoomdata-edc-aurora
    - zoomdata-edc-cloudera-search
    - zoomdata-edc-elasticsearch-1.7
    - zoomdata-edc-elasticsearch-2.0
    - zoomdata-edc-impala
    - zoomdata-edc-memsql
    - zoomdata-edc-mssql
    - zoomdata-edc-mysql
    - zoomdata-edc-oracle
    - zoomdata-edc-phoenix-4.5
    - zoomdata-edc-postgresql
    - zoomdata-edc-redshift
    - zoomdata-edc-rts
    - zoomdata-edc-sparksql
    - zoomdata-edc-tez
    - zoomdata-scheduler
    - zoomdata-spark-proxy
    - zoomdata
    #- zoomdata-xvfb
